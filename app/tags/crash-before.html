<pop-crash-before>
    <img id="crash-image" src="images/crash_before.png" onclick="{ opts.onClickImage }"/>
    <div id="building-initial"> {opts.buildingInitial}</div>
    <back-svg id="back-icon" onclick={goNameView}></back-svg>
    <question-svg id="question-icon" onclick={showHelp}></question-svg>

    <script>
        this.crashImage = null;
        this.buildingInitial = null;
        this.questionIcon = null;
        this.backIcon = null;

        this.on('mount', () => {
            console.log("crash before mounted");

            this.crashImage = document.getElementById("crash-image");
            this.buildingInitial = document.getElementById("building-initial");
            this.questionIcon = document.getElementById("question-icon");
            this.backIcon = document.getElementById("back-icon");

            this.crashImage.onload = () => this.calcComponentPosition();
            window.addEventListener("resize", this.calcComponentPosition);
        });

        this.on('before-unmount', function () {
            window.removeEventListener("resize", this.calcComponentPosition);
        });

        this.goNameView = function () {
            route("/");
        };

        this.showHelp = function () {
            this.showHelp = function () {
                swal("画像をタップか、端末を振る");
            };
        };

        this.calcComponentPosition = (e) => {
            const {clientWidth, clientHeight} = this.crashImage;

            this.buildingInitial.style.top = clientHeight * 0.44;
            this.buildingInitial.style.left = clientWidth * 0.235;
            this.buildingInitial.style.width = clientWidth * 0.1;
            this.buildingInitial.style.fontSize = clientWidth * 0.05;

            this.backIcon.style.top = clientHeight * 0.05;
            this.backIcon.style.left = clientWidth * 0.05;
            this.backIcon.style.height = clientWidth * 0.08;
            this.backIcon.style.width = clientWidth * 0.08;

            this.questionIcon.style.top = clientHeight * 0.05;
            this.questionIcon.style.right = clientWidth * 0.05;
            this.questionIcon.style.height = clientWidth * 0.08;
            this.questionIcon.style.width = clientWidth * 0.08;
        }
    </script>

    <style>
        #crash-image {
            width: 100%;
            height: auto;
        }

        #building-initial {
            position: absolute;
            text-align: center;
            transform: rotate(15deg) scale(0.9, 1);;
        }

        #question-icon {
            position: absolute;
        }

        #back-icon {
            position: absolute;
        }
    </style>
</pop-crash-before>
